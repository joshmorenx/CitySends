{% load static %}
{% block content %}
			<html>
			<head>
				<!--<link href="https://fonts.googleapis.com/css?family=Crete+Round" rel="stylesheet">
				 Resources -->
				<link rel="stylesheet" type="text/css" href="{% static 'blog/style_extractor.css' %}">
				<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
				<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
				<script src="https://cdn.amcharts.com/lib/4/maps.js"></script>
				<script src="https://cdn.amcharts.com/lib/4/geodata/mexicoLow.js"></script>
				<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
				<script src="{% static 'blog/stopword/dist/stopword.js' %}"></script>
			</head>
			<body>
				<header>
					<p><h1><span style="color: #ff6600;">City</span><span style="color: #93a603;">Sends</span></h1></p>
					<p><h1 align="center">Plataforma de visualización de dinámicas sociales</h1></p>
					
				</header>
				
 				<div id="nav">
					<a href="#">Inicio</a>
					<a href="#">CONACYT</a>
					<a href="#">Geoint</a>
					<a href="#">CentroGeo</a>
					<a href="#">UniLeon</a>
					<div id="busqueda">
						<div id="filtre">
							<label id="filtrar" for="busqueda">filtrar</label>
							<div class="wrapped-content">
								<div class="arrow-up">
								</div>
									<div class="popup-filter">
											<div class="labeler">
												<label for="username"> Username </label>
												<input id="username" type="text" name="username" placeholder="Search posts by username"/>
											</div>
											<div class="labeler">
												<label for="date1">From</label>
												<input id="date1" type="date" name="date1"/>

												<label for="date2">To</label>
												<input id="date2" type="date" name="date2"/>	
											</div>
											<div class="labeler">
												<input type="submit" value="Search"/>
											</div>
									</div>
								</div>
							</div>
						<form action="." method="POST">{% csrf_token %}
							<input id="busqueda" type="text" name="busqueda" placeholder="Your Search" required/>
							<input type="submit" value="Search"/>

														<div class="wrapped-content">
								<div class="arrow-up">
								</div>
									<div class="popup-filter">
											<div class="labeler">
												<label for="username"> Username </label>
												<input id="username" type="text" name="username" placeholder="Search posts by username"/>
											</div>
											<div class="labeler">
												<label for="date1">From</label>
												<input id="date1" type="date" name="date1"/>

												<label for="date2">To</label>
												<input id="date2" type="date" name="date2"/>	
											</div>
											<div class="labeler">
												<input type="submit" value="Search"/>
											</div>
									</div>
								</div>
							</div>
						</form>
					</div>
				</div>
				<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
				<script>
					var selector = null
					var firstTd = []
				</script>
					<!--	Renderiza el resultado de la busqueda	-->
					<div style="text-align:center; width=100%; border-top: 1px solid black" class="resultado">
					{% if encontrar %}

						<table style="width:100%; border: 2px solid black;">
							<tr style="background-color:cyan">
								<th>Index</th>
								<th>Id</th>
								<th>Post</th>
								<th>Fecha</th>
								<th>Latitud</th>
								<th>Longitud</th>
							</tr>
							<script>
								var selector = []
							</script>
							{% for result in encontrar %}
							<tr>
								<td id ="indexar" width="100" style="border: 2px solid black"></td>
								<td width="100" style="border: 2px solid black">{{ result.author }}</td>
								<td width="100" style="border: 2px solid black">{{ result.content }}</td>
								<td width="100" style="border: 2px solid black">{{ result.date_posted }}</td>
								<td width="100" style="border: 2px solid black">{{ result.latitude }}</td>
								<td width="100" style="border: 2px solid black">{{ result.longitude }}</td>
							</tr>
								
								<script>
									var excluir = 'es este éste mi según hola casi debo ni hay la los les las que y son yo tu el ella nosotros nosotras ustedes ellos ellas a ante para de desde cabe con contra sin sobre tras'.split(' ')
									var oldString = '{{ result.content }}'.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi, '').split()
									selector += oldString+' '
								</script>
							{% endfor %}
							<script>
								firstTd.push(document.querySelectorAll('#indexar'))
								indexCount = () => {
										var i = 0
										for (var itemz of firstTd[0]) {
											i+=1
											itemz.textContent = i										
										}
									}
									indexCount()

								selector = selector.split(' ')
								var newString = sw.removeStopwords(selector, excluir)
								newString = newString.toString()
								/*var nuevoItem = document.createElement('div')
								nuevoItem.setAttribute('id', 'nuevo-item')
								document.body.appendChild(nuevoItem)
								document.getElementById('nuevo-item').innerHTML = newString 
								$(nuevoItem).css('border','1px solid black')*/
							</script>
						</table>
						<br>

						        <button type="button" onclick="tableToCSV()">
									DESCARGAR CSV
								</button>
								<button type="button" onclick="tableToJSON()">
									DESCARGAR JSON
								</button>


								
							{{ find }}
						{% endif %}
					</div>
	<!--	Renderiza el resultado de la busqueda	-->

<div id="chartdiv2"></div>
					<script type="text/javascript">
						if(selector != null){
							$('#chartdiv2').show()
						}
						else{
							$('#chartdiv2').hide()
						}
					</script>	
				<main>
					<section>
						<article>
							<!-- Chart code -->
			
		<style>
			#chartdiv2 {
				width: 100%;
				height: 500px;
			}
		</style>

		<!--Resources -->	
		<script src="https://cdn.amcharts.com/lib/4/plugins/wordCloud.js"></script>
		<script>
			am4core.ready(function() {
		
	// Themes begin
	am4core.useTheme(am4themes_animated);
	// Themes end

	var chart = am4core.create("chartdiv2", am4plugins_wordCloud.WordCloud);
	var series = chart.series.push(new am4plugins_wordCloud.WordCloudSeries());

	series.accuracy = 4;
	series.step = 15;
	series.rotationThreshold = 0.7;
	series.maxCount = 200;
	series.minWordLength = 2;
	series.labels.template.margin(4,4,4,4);
	series.maxFontSize = am4core.percent(30);

	series.text = newString//"mérida hombre permanece calidad desconocido falleció arrollado periférico intentaba cruzar transitadahechos ocurrieron mañana kilómetro puente mulchechén kanasín conductor según testigos bajó hombre cuál aventó varios metros darse cuenta mató huyó lugar zona acordonada espera semefo montó operativo vialidad conductor responsable detenido entrada texan palomeque departamento unidos informó junta nacional seguridad transporte ayudará méxico investigación accidente helicóptero murieron gobernadora puebla martha erika alonso esposo rafael moreno valle coordinador senadores tres personas unidos hará “una excepción” debido actualmente cierre gobierno país disputa fondos exige presidente donald trump construir muro frontera méxico pasado diciembre subsecretaria asuntos hemisferio occidental kimberly breier confirmó noticia través redes sociales informó solicitud departamento junta nacional seguridad transporte ntsb siglas inglés enviará investigador asistir gobierno méxico trágico accidente helicóptero mató cinco personas incluidos funcionarios gubernamentales kimberly brier expresó condolencias víctimas accidente aéreo registrado pasado diciembre además colaboración unidos equipo expertos canadá inició investigaciones pasado diciembre tragedia aérea colaborarán autoridades mexicanas esclarecer causas desplome helicóptero peritos concentraron lugar impactó aeronave después trabajo campo realizarán investigación gabinete elementos ejército mexicano policía estatal fiscalía mantienen acordonada zona existe fecha determinada concluir investigaciones lugar accidente desplegado personal armadora helicóptero aseguradora colaborar indagaciones dueño terreno cayó aeronave acudió lugar saber cuándo desocupado predio zona sembradío coronango puebla llegó gilberto higuera bernal fiscal general puebla detalló cómo trabajando investigaciones llevamos procuraduría general república fiscalía avanzando diligencia realizar revisión inspección seguramente levantamiento resto aeronave” señaló funcionario titular secretaría comunicaciones transportes javier jiménez espriú confirmó canadienses dieron inicio trabajos sabemos cuándo dictamen proceso sencillo remover sitio restos aparato tomar muestras pertinentes” fuente noticireos televisa paredes centro activo freire ideología izquierda vinculada filosofía marxista— retumbaban años covers beatles luthiers agrupación aves rapiña interpretaban bajista banda emmanuel lubezki adolescencia rienda suelta pasión música persiste junto triunfo cinefotógrafo siglo pasado chivo compartió melomanía santiago ojeda guitarras manuel rocha iturbide teclados juan sebastián barberá batería compuso cuatro canciones disolver banda arte sonoro protagonista vida gracias muni lubezki raquel morgenstern “siempre cerca mamá papá oían música clásica tipo siempre fascinó suerte descubrí temprana edad pésimo músico funcionar risas relación interesante artes puede aprender música cómo transmitir emoción haciendo” dijo lubezki milenio conexión euterpe sigue reciente visita méxico ofreció clase magistral escenario sala nezahualcóyotl platicó entrañas sala miguel covarrubias lugares máxima tradición musical sentado camerino pasadas horas emmanuel sinceró contó planes legado sonoridad “oyes música sientes parte cerebro probablemente prehistórica cine puede encantaría llegar hacer gran pantalla” reveló lubezki tras convivencia experimentados noveles fotógrafos contexto cuarta edición canon zoom project ciudad méxico acercamiento quehacer cinematográfico particular cinefotografía ganó partida bajo guía graciela iturbide documentaba población indígena méxico inseparable cámara kodak retina genio lente comprendió cosa encantaba fotografía llevó muchísimo tiempo sentirme cómodo haciendo foto fija “cuando empecé cuec obviamente convertí cinefotógrafo haciendo décadas” explicó tiempo aseguró humildad triunfos obtenidos resultado colaboración “suerte trabajar directores realmente autores cine” asignaturas pendientes chivo lubezki compartió partida hollywood obedeció búsqueda —nada sencilla— hacer cine falta apoyo ángeles encontró realización producciones diferencia país “nada apoyo pudimos hacer solo pareja bandidos películas mucha suerte momento produjeron películas tipo bien empecé trabajar allá asunto vida nunca planeé irme aquí siquiera hablaba inglés contrataron hacer película estadunidense aquí mismo tiempo éxito agua chocolate 1992 solo pareja 1991 hizo nombre oyera hollywood fotógrafo barato empezaron llamar hacer películas trabajo allá aquí eché raíces ángeles nunca planeé” agregó mismo aseguró enorgullece academia ciencias artes cinematográficas quiere decir mejor trabajo siempre tener mente nominado ganaba oscar alguna manera sentía honor “que fotografía gustado mayoría miembros academia hacía sentir alguna manera bien suena raro pensaba hacía sentir incómodos gané siempre gran alegría luego gran pregunta ‘¿qué significa trabajo comercial mediocre’ siempre dudando” enfatizó claves oscura emmanuel chivo lubezki aseguró donald trump recuerda llegada poder mussolini hitler terror detesto profundamente equipo” misión compromiso destacado cinefotógrafo mantiene intacto tantos años carrera “espero poder hacer películas mejores hecho ahora” compartió nostalgia reveló extraña méxico familia amigos comida música… siempre cómodo gente aquí” humilde carrera prolífica reconocimientos oscar bafta ariel mexicano dijo cuesta “mucho trabajo trabajo entenderme contexto” histórico febrero 2016 ganó tercer premio academia consecutivo mejor fotografía trabajo revenant alejandro gonzález iñárritu estudio revela mayoría gatos sobreviven tras caer lugares considerablemente altos gatos famosos caer presentar daños considerables pesar sufrir caídas sitios altos incluso reportes gato saltó ventana piso edificio nueva york tras tratado pulmones diente astillado volvió casa sólo días historias caso aislado ciencia dedicado descifrar cuál secreto detrás capacidad supervivencia primero encontró gatos flexibilidad espina dorsal carencia clavículas funcionales hombros permite torcer cuerpo mientras caen facilita casi siempre aterrizar habilidad conocida “reflejo giro gato” surge primeras semanas vida aunque perfeccionada siete semanas vida";

	series.colors = new am4core.ColorSet();
	series.colors.passOptions = {}; // makes it loop

	//series.labelsContainer.rotation = 45;
	series.angles = [0,-90];
	series.fontWeight = "700"

	setInterval(function () {
		series.dataItems.getIndex(Math.round(Math.random() * (series.dataItems.length - 1))).setValue("value", Math.round(Math.random() * 10));
	}, 10000)

	}); // end am4core.ready()
</script>

<!-- HTML -->

</article>
</section>
</main>
<footer align = "center">

</footer>
<p>Plataforma de visualización de dinámicas sociales</p>
    <div style="display: none;" id="addContainer">
      <h2>Language</h2>
      <p><select id="languages"></select> Check which <a href="https://github.com/fergiemcdowall/stopword#language-code">Language code</a> to use.</p>
      <h2>Text with stopwords</h2>
      <input type="text" id="text" placeholder="Add some text" /><br />
    </div>
    <div style="display: none;" id="newString">
      <h2>Resultado</h2>
      <div id="stopwordsRemoved"></div>
    </div>
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="{% static 'blog/extract.js'%}"></script>
	<script src="{% static 'blog/stopword/separador/stopword-app.js' %}"></script>
</body>
</html>

<script type="text/javascript">
									function tableToCSV() {
							
										// Variable to store the final csv data
										var csv_data = [];
							
										// Get each row data
										var rows = document.getElementsByTagName('tr');
										for (var i = 0; i < rows.length; i++) {
							
											// Get each column data
											var cols = rows[i].querySelectorAll('td,th');
							
											// Stores each csv row data
											var csvrow = [];
											for (var j = 0; j < cols.length; j++) {
							
												// Get the text data of each cell
												// of a row and push it to csvrow
												csvrow.push('"'+cols[j].textContent+'"');
											}
							
											// Combine each column value with comma
											csv_data.push(csvrow.join(","));
										}
							
										// Combine each row data with new line character
										csv_data = csv_data.join('\n');
							
										// Call this function to download csv file 
										downloadCSVFile(csv_data);
							
									}
							
									function downloadCSVFile(csv_data) {
							
										// Create CSV file object and feed
										// our csv_data into it
										CSVFile = new Blob([csv_data], {
											type: "text/csv"
										});
							
										// Create to temporary link to initiate
										// download process
										var temp_link = document.createElement('a');
							
										// Download csv file
										temp_link.download = "GfG.csv";
										var url = window.URL.createObjectURL(CSVFile);
										temp_link.href = url;
							
										// This link should not be displayed
										temp_link.style.display = "none";
										document.body.appendChild(temp_link);
							
										// Automatically click the link to
										// trigger download
										temp_link.click()
										document.body.removeChild(temp_link);
									}
									
									function tableToJSON(){
										var myRows = []
										var $headers = $("th")
										var $rows = $("tr").each(function(index) {
										$cells = $(this).find("td")
										myRows[index] = {}
										$cells.each(function(cellIndex) {
											myRows[index][$($headers[cellIndex]).html()] = $(this).html()
											})
										})
										// Let's put this in the object like you want and convert to JSON (Note: jQuery will also do this for you on the Ajax request)
										var myObj = {}
										myObj.myrows = myRows

										JSONFile = new Blob([JSON.stringify(myObj)], {
											type: "text/JSON"
										});
							
										// Create to temporary link to initiate
										// download process
										var temp_link = document.createElement('a');
							
										// Download csv file
										temp_link.download = "GfG.json";
										var url = window.URL.createObjectURL(JSONFile);
										temp_link.href = url;
							
										// This link should not be displayed
										temp_link.style.display = "none";
										document.body.appendChild(temp_link);
							
										// Automatically click the link to
										// trigger download
										temp_link.click()
										document.body.removeChild(temp_link);
									}

								</script>
{% endblock %}